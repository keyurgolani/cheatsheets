<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nginx Configuration Cheatsheet</title>
    <link rel="stylesheet" href="../styles.css">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="../script.js" defer></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-content">
            <a href="../index.html" class="nav-brand">
                <i class="ph ph-books"></i> Cheatsheets
            </a>
            <div class="nav-controls">
                <button id="theme-toggle" class="btn-icon" aria-label="Toggle theme">
                    <i class="ph ph-moon"></i>
                </button>
                <button id="download-btn" class="btn-icon" aria-label="Download PDF">
                    <i class="ph ph-download-simple"></i>
                </button>
                <a href="https://github.com/keyurgolani/Cheatsheets" class="btn-icon" aria-label="GitHub" target="_blank" rel="noopener noreferrer">
                    <i class="ph ph-github-logo"></i>
                </a>
            </div>
        </div>
    </nav>

    <div class="container">
        <header class="cheatsheet-header">
            <h1>‚öôÔ∏è Nginx Configuration</h1>
            <p>Web server configuration essentials and best practices</p>
            <div class="search-container" style="margin-top: 1.5rem; margin-bottom: 0;">
                <span class="search-icon"><i class="ph ph-magnifying-glass"></i></span>
                <input type="text" class="search-input" id="cheatsheet-search" placeholder="Filter this cheatsheet..." aria-label="Filter cheatsheet">
            </div>
        </header>

        <div class="masonry-grid" id="cheatsheet-grid">
            
            <div class="card" id="basic-configuration-structure">
                <div class="card-header">üöÄ Basic Configuration Structure</div>
                <div class="code-block">
                    <div class="code-line"><span class="comment"># Main context</span></div><div class="code-line"><span class="keyword">user</span> nginx;</div><div class="code-line"><span class="keyword">worker_processes</span> auto;</div><div class="code-line"><span class="keyword">error_log</span> /var/log/nginx/error.log;</div><div class="code-line"></div><div class="code-line"><span class="keyword">events</span> {</div><div class="code-line"> <span class="keyword">worker_connections</span> 1024;</div><div class="code-line">}</div><div class="code-line"></div><div class="code-line"><span class="keyword">http</span> {</div><div class="code-line"> <span class="comment"># HTTP context</span></div><div class="code-line"> <span class="keyword">include</span> /etc/nginx/mime.types;</div><div class="code-line"> <span class="keyword">default_type</span> application/octet-stream;</div><div class="code-line">}</div>
                </div>
            </div>
            <div class="card" id="server-block-virtual-host">
                <div class="card-header">üåê Server Block (Virtual Host)</div>
                <div class="code-block">
                    <div class="code-line"><span class="keyword">server</span> {</div><div class="code-line"> <span class="keyword">listen</span> 80;</div><div class="code-line"> <span class="keyword">listen</span> [::]:80;</div><div class="code-line"> <span class="keyword">server_name</span> example.com www.example.com;</div><div class="code-line"></div><div class="code-line"> <span class="keyword">root</span> /var/www/html;</div><div class="code-line"> <span class="keyword">index</span> index.html index.htm;</div><div class="code-line"></div><div class="code-line"> <span class="keyword">access_log</span> /var/log/nginx/access.log;</div><div class="code-line"> <span class="keyword">error_log</span> /var/log/nginx/error.log;</div><div class="code-line">}</div>
                </div>
            </div>
            <div class="card" id="location-blocks">
                <div class="card-header">üìç Location Blocks</div>
                <div class="code-block">
                    <div class="code-line"><span class="comment"># Exact match</span></div><div class="code-line"><span class="keyword">location</span> = /path {</div><div class="code-line"> <span class="comment"># Matches /path exactly</span></div><div class="code-line">}</div><div class="code-line"></div><div class="code-line"><span class="comment"># Prefix match</span></div><div class="code-line"><span class="keyword">location</span> /images/ {</div><div class="code-line"> <span class="comment"># Matches /images/*</span></div><div class="code-line">}</div><div class="code-line"></div><div class="code-line"><span class="comment"># Regex match (case-sensitive)</span></div><div class="code-line"><span class="keyword">location</span> ~ \.php$ {</div><div class="code-line"> <span class="comment"># Matches .php files</span></div><div class="code-line">}</div><div class="code-line"></div><div class="code-line"><span class="comment"># Regex match (case-insensitive)</span></div><div class="code-line"><span class="keyword">location</span> ~* \.(jpg|png|gif)$ {</div><div class="code-line"> <span class="comment"># Matches image files</span></div><div class="code-line">}</div><div class="code-line"></div><div class="code-line"><span class="comment"># Priority prefix match</span></div><div class="code-line"><span class="keyword">location</span> ^~ /static/ {</div><div class="code-line"> <span class="comment"># Stops regex matching</span></div><div class="code-line">}</div>
                </div>
            </div>
            <div class="card" id="reverse-proxy-configuration">
                <div class="card-header">üîÑ Reverse Proxy Configuration</div>
                <div class="code-block">
                    <div class="code-line"><span class="keyword">location</span> / {</div><div class="code-line"> <span class="keyword">proxy_pass</span> http://localhost:3000;</div><div class="code-line"> <span class="keyword">proxy_http_version</span> 1.1;</div><div class="code-line"></div><div class="code-line"> <span class="comment"># Headers</span></div><div class="code-line"> <span class="keyword">proxy_set_header</span> Host $host;</div><div class="code-line"> <span class="keyword">proxy_set_header</span> X-Real-IP $remote_addr;</div><div class="code-line"> <span class="keyword">proxy_set_header</span> X-Forwarded-For $proxy_add_x_forwarded_for;</div><div class="code-line"> <span class="keyword">proxy_set_header</span> X-Forwarded-Proto $scheme;</div><div class="code-line"></div><div class="code-line"> <span class="comment"># WebSocket support</span></div><div class="code-line"> <span class="keyword">proxy_set_header</span> Upgrade $http_upgrade;</div><div class="code-line"> <span class="keyword">proxy_set_header</span> Connection <span class="string">"upgrade"</span>;</div><div class="code-line"></div><div class="code-line"> <span class="comment"># Timeouts</span></div><div class="code-line"> <span class="keyword">proxy_connect_timeout</span> 60s;</div><div class="code-line"> <span class="keyword">proxy_send_timeout</span> 60s;</div><div class="code-line"> <span class="keyword">proxy_read_timeout</span> 60s;</div><div class="code-line">}</div>
                </div>
            </div>
            <div class="card" id="load-balancing">
                <div class="card-header">‚öñÔ∏è Load Balancing</div>
                <div class="code-block">
                    <div class="code-line"><span class="keyword">upstream</span> backend {</div><div class="code-line"> <span class="comment"># Round-robin (default)</span></div><div class="code-line"> <span class="keyword">server</span> backend1.example.com;</div><div class="code-line"> <span class="keyword">server</span> backend2.example.com;</div><div class="code-line"> <span class="keyword">server</span> backend3.example.com;</div><div class="code-line">}</div><div class="code-line"></div><div class="code-line"><span class="keyword">upstream</span> weighted {</div><div class="code-line"> <span class="comment"># Weighted distribution</span></div><div class="code-line"> <span class="keyword">server</span> backend1.example.com weight=3;</div><div class="code-line"> <span class="keyword">server</span> backend2.example.com weight=1;</div><div class="code-line">}</div><div class="code-line"></div><div class="code-line"><span class="keyword">upstream</span> ip_hash_backend {</div><div class="code-line"> <span class="comment"># Session persistence</span></div><div class="code-line"> <span class="keyword">ip_hash</span>;</div><div class="code-line"> <span class="keyword">server</span> backend1.example.com;</div><div class="code-line"> <span class="keyword">server</span> backend2.example.com;</div><div class="code-line">}</div><div class="code-line"></div><div class="code-line"><span class="keyword">upstream</span> least_conn_backend {</div><div class="code-line"> <span class="comment"># Least connections</span></div><div class="code-line"> <span class="keyword">least_conn</span>;</div><div class="code-line"> <span class="keyword">server</span> backend1.example.com;</div><div class="code-line"> <span class="keyword">server</span> backend2.example.com;</div><div class="code-line">}</div>
                </div>
            </div>
            <div class="card" id="ssltls-configuration">
                <div class="card-header">üîí SSL/TLS Configuration</div>
                <div class="code-block">
                    <div class="code-line"><span class="keyword">server</span> {</div><div class="code-line"> <span class="keyword">listen</span> 443 ssl http2;</div><div class="code-line"> <span class="keyword">listen</span> [::]:443 ssl http2;</div><div class="code-line"> <span class="keyword">server_name</span> example.com;</div><div class="code-line"></div><div class="code-line"> <span class="comment"># SSL certificates</span></div><div class="code-line"> <span class="keyword">ssl_certificate</span> /path/to/cert.pem;</div><div class="code-line"> <span class="keyword">ssl_certificate_key</span> /path/to/key.pem;</div><div class="code-line"></div><div class="code-line"> <span class="comment"># SSL protocols and ciphers</span></div><div class="code-line"> <span class="keyword">ssl_protocols</span> TLSv1.2 TLSv1.3;</div><div class="code-line"> <span class="keyword">ssl_ciphers</span> HIGH:!aNULL:!MD5;</div><div class="code-line"> <span class="keyword">ssl_prefer_server_ciphers</span> on;</div><div class="code-line"></div><div class="code-line"> <span class="comment"># SSL session cache</span></div><div class="code-line"> <span class="keyword">ssl_session_cache</span> shared:SSL:10m;</div><div class="code-line"> <span class="keyword">ssl_session_timeout</span> 10m;</div><div class="code-line"></div><div class="code-line"> <span class="comment"># HSTS</span></div><div class="code-line"> <span class="keyword">add_header</span> Strict-Transport-Security <span class="string">"max-age=31536000"</span> always;</div><div class="code-line">}</div><div class="code-line"></div><div class="code-line"><span class="comment"># HTTP to HTTPS redirect</span></div><div class="code-line"><span class="keyword">server</span> {</div><div class="code-line"> <span class="keyword">listen</span> 80;</div><div class="code-line"> <span class="keyword">server_name</span> example.com;</div><div class="code-line"> <span class="keyword">return</span> 301 https://$server_name$request_uri;</div><div class="code-line">}</div>
                </div>
            </div>
            <div class="card" id="static-file-serving">
                <div class="card-header">üì¶ Static File Serving</div>
                <div class="code-block">
                    <div class="code-line"><span class="keyword">location</span> /static/ {</div><div class="code-line"> <span class="keyword">alias</span> /var/www/static/;</div><div class="code-line"> <span class="keyword">expires</span> 30d;</div><div class="code-line"> <span class="keyword">add_header</span> Cache-Control <span class="string">"public, immutable"</span>;</div><div class="code-line">}</div><div class="code-line"></div><div class="code-line"><span class="keyword">location</span> ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {</div><div class="code-line"> <span class="keyword">expires</span> 1y;</div><div class="code-line"> <span class="keyword">add_header</span> Cache-Control <span class="string">"public, immutable"</span>;</div><div class="code-line"> <span class="keyword">access_log</span> off;</div><div class="code-line">}</div><div class="code-line"></div><div class="code-line"><span class="comment"># Gzip compression</span></div><div class="code-line"><span class="keyword">gzip</span> on;</div><div class="code-line"><span class="keyword">gzip_vary</span> on;</div><div class="code-line"><span class="keyword">gzip_types</span> text/plain text/css application/json application/javascript text/xml;</div><div class="code-line"><span class="keyword">gzip_min_length</span> 1000;</div>
                </div>
            </div>
            <div class="card" id="security-headers">
                <div class="card-header">üîê Security Headers</div>
                <div class="code-block">
                    <div class="code-line"><span class="comment"># Add security headers</span></div><div class="code-line"><span class="keyword">add_header</span> X-Frame-Options <span class="string">"SAMEORIGIN"</span> always;</div><div class="code-line"><span class="keyword">add_header</span> X-Content-Type-Options <span class="string">"nosniff"</span> always;</div><div class="code-line"><span class="keyword">add_header</span> X-XSS-Protection <span class="string">"1; mode=block"</span> always;</div><div class="code-line"><span class="keyword">add_header</span> Referrer-Policy <span class="string">"no-referrer-when-downgrade"</span> always;</div><div class="code-line"><span class="keyword">add_header</span> Content-Security-Policy <span class="string">"default-src 'self'"</span> always;</div><div class="code-line"></div><div class="code-line"><span class="comment"># Hide Nginx version</span></div><div class="code-line"><span class="keyword">server_tokens</span> off;</div><div class="code-line"></div><div class="code-line"><span class="comment"># Limit request size</span></div><div class="code-line"><span class="keyword">client_max_body_size</span> 10M;</div><div class="code-line"></div><div class="code-line"><span class="comment"># Rate limiting</span></div><div class="code-line"><span class="keyword">limit_req_zone</span> $binary_remote_addr zone=mylimit:10m rate=10r/s;</div><div class="code-line"><span class="keyword">limit_req</span> zone=mylimit burst=20 nodelay;</div>
                </div>
            </div>
            <div class="card" id="redirects-rewrites">
                <div class="card-header">üéØ Redirects & Rewrites</div>
                <div class="code-block">
                    <div class="code-line"><span class="comment"># Permanent redirect</span></div><div class="code-line"><span class="keyword">return</span> 301 https://example.com$request_uri;</div><div class="code-line"></div><div class="code-line"><span class="comment"># Temporary redirect</span></div><div class="code-line"><span class="keyword">return</span> 302 /new-location;</div><div class="code-line"></div><div class="code-line"><span class="comment"># Rewrite URL</span></div><div class="code-line"><span class="keyword">rewrite</span> ^/old-path/(.*)$ /new-path/$1 permanent;</div><div class="code-line"></div><div class="code-line"><span class="comment"># Conditional redirect</span></div><div class="code-line"><span class="keyword">if</span> ($host != <span class="string">"example.com"</span>) {</div><div class="code-line"> <span class="keyword">return</span> 301 https://example.com$request_uri;</div><div class="code-line">}</div><div class="code-line"></div><div class="code-line"><span class="comment"># Try files in order</span></div><div class="code-line"><span class="keyword">try_files</span> $uri $uri/ /index.html;</div>
                </div>
            </div>
            <div class="card" id="php-fpm-configuration">
                <div class="card-header">üêò PHP-FPM Configuration</div>
                <div class="code-block">
                    <div class="code-line"><span class="keyword">location</span> ~ \.php$ {</div><div class="code-line"> <span class="keyword">fastcgi_pass</span> unix:/var/run/php/php8.1-fpm.sock;</div><div class="code-line"> <span class="keyword">fastcgi_index</span> index.php;</div><div class="code-line"> <span class="keyword">fastcgi_param</span> SCRIPT_FILENAME $document_root$fastcgi_script_name;</div><div class="code-line"> <span class="keyword">include</span> fastcgi_params;</div><div class="code-line"></div><div class="code-line"> <span class="comment"># Security: prevent access to hidden files</span></div><div class="code-line"> <span class="keyword">fastcgi_param</span> PHP_VALUE <span class="string">"open_basedir=$document_root:/tmp/"</span>;</div><div class="code-line">}</div><div class="code-line"></div><div class="code-line"><span class="comment"># Deny access to .php files in uploads</span></div><div class="code-line"><span class="keyword">location</span> ~* /uploads/.*\.php$ {</div><div class="code-line"> <span class="keyword">deny</span> all;</div><div class="code-line">}</div>
                </div>
            </div>
            <div class="card" id="common-directives">
                <div class="card-header">üîß Common Directives</div>
                <div class="code-block">
                    
                </div>
            </div>
            <div class="card" id="nginx-commands">
                <div class="card-header">üõ†Ô∏è Nginx Commands</div>
                <div class="code-block">
                    
                </div>
            </div>
            <div class="card" id="logging-configuration">
                <div class="card-header">üìù Logging Configuration</div>
                <div class="code-block">
                    <div class="code-line"><span class="comment"># Custom log format</span></div><div class="code-line"><span class="keyword">log_format</span> main <span class="string">'$remote_addr - $remote_user [$time_local] '</span></div><div class="code-line"> <span class="string">'"$request" $status $body_bytes_sent '</span></div><div class="code-line"> <span class="string">'"$http_referer" "$http_user_agent"'</span>;</div><div class="code-line"></div><div class="code-line"><span class="comment"># JSON log format</span></div><div class="code-line"><span class="keyword">log_format</span> json escape=json <span class="string">'{'</span></div><div class="code-line"> <span class="string">'"time":"$time_iso8601",'</span></div><div class="code-line"> <span class="string">'"remote_addr":"$remote_addr",'</span></div><div class="code-line"> <span class="string">'"request":"$request",'</span></div><div class="code-line"> <span class="string">'"status":$status,'</span></div><div class="code-line"> <span class="string">'"body_bytes_sent":$body_bytes_sent'</span></div><div class="code-line"><span class="string">'}'</span>;</div><div class="code-line"></div><div class="code-line"><span class="keyword">access_log</span> /var/log/nginx/access.log main;</div><div class="code-line"><span class="keyword">error_log</span> /var/log/nginx/error.log warn;</div>
                </div>
            </div>
            <div class="card" id="spa-single-page-application">
                <div class="card-header">üé® SPA (Single Page Application)</div>
                <div class="code-block">
                    <div class="code-line"><span class="keyword">server</span> {</div><div class="code-line"> <span class="keyword">listen</span> 80;</div><div class="code-line"> <span class="keyword">server_name</span> app.example.com;</div><div class="code-line"> <span class="keyword">root</span> /var/www/app/dist;</div><div class="code-line"> <span class="keyword">index</span> index.html;</div><div class="code-line"></div><div class="code-line"> <span class="comment"># Handle client-side routing</span></div><div class="code-line"> <span class="keyword">location</span> / {</div><div class="code-line"> <span class="keyword">try_files</span> $uri $uri/ /index.html;</div><div class="code-line">    }</div><div class="code-line"></div><div class="code-line"> <span class="comment"># Cache static assets</span></div><div class="code-line"> <span class="keyword">location</span> ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {</div><div class="code-line"> <span class="keyword">expires</span> 1y;</div><div class="code-line"> <span class="keyword">add_header</span> Cache-Control <span class="string">"public, immutable"</span>;</div><div class="code-line">    }</div><div class="code-line"></div><div class="code-line"> <span class="comment"># API proxy</span></div><div class="code-line"> <span class="keyword">location</span> /api/ {</div><div class="code-line"> <span class="keyword">proxy_pass</span> http://localhost:3000/;</div><div class="code-line"> <span class="keyword">proxy_set_header</span> Host $host;</div><div class="code-line"> <span class="keyword">proxy_set_header</span> X-Real-IP $remote_addr;</div><div class="code-line">    }</div><div class="code-line">}</div>
                </div>
            </div>
            <div class="card" id="best-practices">
                <div class="card-header">üí° Best Practices</div>
                <div class="code-block">
                    
                </div>
            </div>
            <div class="card" id="debugging-troubleshooting">
                <div class="card-header">üîç Debugging & Troubleshooting</div>
                <div class="code-block">
                    <div class="code-line"><span class="comment"># Enable debug logging</span></div><div class="code-line"><span class="keyword">error_log</span> /var/log/nginx/error.log debug;</div><div class="code-line"></div><div class="code-line"><span class="comment"># Check which config file is being used</span></div><div class="code-line">$ nginx -V</div><div class="code-line"></div><div class="code-line"><span class="comment"># View error logs</span></div><div class="code-line">$ tail -f /var/log/nginx/error.log</div><div class="code-line"></div><div class="code-line"><span class="comment"># View access logs</span></div><div class="code-line">$ tail -f /var/log/nginx/access.log</div><div class="code-line"></div><div class="code-line"><span class="comment"># Check listening ports</span></div><div class="code-line">$ netstat -tlnp | grep nginx</div><div class="code-line"></div><div class="code-line"><span class="comment"># Test upstream connectivity</span></div><div class="code-line">$ curl -I http://localhost:3000</div>
                </div>
            </div>
            <div class="card" id="useful-variables">
                <div class="card-header">üìö Useful Variables</div>
                <div class="code-block">
                    
                </div>
            </div>
        </div>

        <footer>
            <p>&copy; 2025 Cheatsheets Collection. Open source and community driven.</p>
        </footer>
    </div>
</body>
</html>